/*
 * Orange angular-swagger-ui - v0.5.4
 *
 * (C) 2015 Orange, all right reserved
 * MIT Licensed
 */
"use strict";angular.module("swaggerUi").service("swagger1Converter",["$q","swaggerModules","swaggerLoader",function(a,b,c){function d(d,g){var h,j=g.openApiSpec.info||{},k=[];j.contact={email:j.contact},j.license={name:j.license,url:j.licenseUrl},j.termsOfService=j.termsOfServiceUrl,g.openApiSpec.info=j,g.openApiSpec.paths={},g.openApiSpec.definitions={},g.openApiSpec.tags=[],g.openApiSpec.swagger="2.0",angular.forEach(g.openApiSpec.apis,function(a){var b=g.url;b.match(/(.*)\?(.*)/)?b=b.replace(/(.*)\?(.*)/,"$1"+a.path+"?$2"):b+=a.path,k.push(c.get({url:b}))}),a.all(k).then(function(a){b.execute(b.BEFORE_CONVERT,a).then(function(){angular.forEach(a,function(a,b){h=g.openApiSpec.apis[b].path,h=h.substring(h.lastIndexOf("/")+1),e(a.openApiSpec,g.openApiSpec,h),f(a.openApiSpec,g.openApiSpec,h),i(a.openApiSpec,g.openApiSpec)}),d.resolve(!0)})["catch"](d.reject)})["catch"](d.reject)}function e(a,b,c){if(b.info.version=b.info.version||a.apiVersion,b.basePath=b.basePath||a.basePath,0===b.basePath.indexOf("http")){var d=angular.element('<a href="'+b.basePath+'"></a>')[0];b.schemes=[d.protocol.replace(":","")],b.host=d.host,b.basePath=d.pathname}b.tags.push({name:c})}function f(a,b,c){var d,e;angular.forEach(a.apis,function(f){d=b.paths[f.path]=b.paths[f.path]||{},angular.forEach(f.operations,function(b){e={},d[b.method.toLowerCase()]={deprecated:angular.isString(b.deprecated)?"true"===b.deprecated:b.deprecated,description:b.notes,summary:b.summary,operationId:b.nickname,produces:b.produces||a.produces,consumes:b.consumes||a.consumes,parameters:b.parameters,responses:e,tags:[c]},g(a,b),h(a,b,e)})})}function g(a,b){angular.forEach(b.parameters,function(b){b["in"]="form"===b.paramType?"formData":b.paramType,b["default"]=b.defaultValue;var c=b.type||b.$ref;a.models&&c&&a.models[c]&&(b.schema={$ref:l(c)},delete b.type)})}function h(a,b,c){var d;angular.forEach(b.responseMessages,function(e){if(d=c[e.code]={description:e.message},e.responseModel)a.models&&a.models[e.responseModel]?d.schema={$ref:l(e.responseModel)}:d.type=e.responseModel;else if(200===e.code&&"void"!==b.type&&(d.schema={type:b.type,$ref:l(b.type)},"array"===b.type)){delete d.schema.$ref;var f=b.items.type||b.items.$ref,g=d.schema.items={};a.models&&a.models[f]?g.$ref=l(f):g.type=f}})}function i(a,b){var c,d=new RegExp("Map\\[string,(.*)\\]"),e=new RegExp("List\\[(.*)\\]"),f=[];angular.forEach(a.models,function(c,g){b.definitions[g]=c,c.subTypes&&f.push(g),angular.forEach(c.properties,function(b){var c=b.type||b.$ref;if(c&&k(c,a))b.$ref=l(c),delete b.type;else if(c&&c.match(d)){delete b.$ref;var f=c.match(d)[1];f&&f.match(e)?(f=f.match(e)[1],b.type="object",b.additionalProperties={type:"array",items:j(f,a)}):(b.type="object",b.additionalProperties=j(f,a))}else b.items?(c=b.items.type||b.items.$ref,k(c,a)&&(b.items.$ref=l(c),delete b.items.type)):b["enum"]&&(b.type="string",delete b.$ref)})}),angular.forEach(f,function(a){var d=b.definitions[a];angular.forEach(d.subTypes,function(d){c=b.definitions[d],c&&(b.definitions[d]={allOf:[{$ref:l(a)},c]})}),delete d.subTypes})}function j(a,b){return k(a,b)?{$ref:l(a)}:{type:a}}function k(a,b){return b.models&&b.models[a]}function l(a){return"#/definitions/"+a}this.execute=function(b){var c=a.defer(),e=b.openApiSpec&&b.openApiSpec.swaggerVersion;return"1.2"===e&&("json"===b.parser||"auto"===b.parser&&"application/json"===b.contentType)?d(c,b):c.resolve(!1),c.promise}}]).run(["swaggerModules","swagger1Converter",function(a,b){a.add(a.BEFORE_PARSE,b,10)}]);